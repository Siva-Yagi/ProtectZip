<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>パスワード付きZIP作成</title>
  <script src="https://cdn.jsdelivr.net/npm/@zip.js/zip.js@2.6.21/dist/zip.min.js"></script>
</head>
<body>
  <h1>パスワード付きZIPファイルを作成</h1>
  <input type="file" id="fileInput" multiple>
  <input type="password" id="password" placeholder="パスワード">
  <button id="btn">ZIPを作成</button>

  <script>
    document.getElementById('btn').onclick = async () => {
      const files = document.getElementById('fileInput').files;
      const password = document.getElementById('password').value;
      if (!files.length || !password) return alert('ZIPファイルとパスワードを入力してください');

      const writer = new zip.BlobWriter('application/zip');
      const zipWriter = new zip.ZipWriter(writer, { password });

      for (const file of files) {
        await zipWriter.add(file.name, new zip.BlobReader(file));
      }
      await zipWriter.close();

      const blob = await writer.getData();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'encrypted.zip';
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(url);
      a.remove();
    };
  </script>
</body>
</html>
